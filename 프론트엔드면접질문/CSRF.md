### CSRF(Cross-Site Request Forgery)

- CSRF는 사용자가 자신의 의도와는 상관없이 인증된 세션을 이용해 공격자가 원하는 작업을 수행하게 만드는 공격 기법이다.
- 예를 들어, 사용자가 특정 웹사이트에 로그인한 상태에서 악의적인 사이트를 방문하면, 해당 사이트에서 사용자의 권한을 악용하여 임의의 요청을 보낼 수 있따.

#### CSRF 공격의 원리

1. 사용자 인증: 사용자가 웹 애플리케이션에 로그인하여 세션을 생성한다. 이때 서버는 세션을 식별하기 위해 쿠키를 클라이언트에 저장한다.

2. 악의적인 사이트 방문: 사용자가 악의적인 사이트를 방문한다. 이 사이트는 사용자의 세션 쿠키를 이용해 서버에 요청을 보낸다.

3. 서버 요청 처리: 서버는 요청이 사용자의 세션 쿠키를 포함하고 있기 때문에 정상적인 요청으로 인식하고 처리한다.

4. 악의적인 행위 발생: 결과적으로 사용자는 자신이 의도하지 않은 작업(예: 비밀번호 변경, 금전 이체 등)을 수행하게 된다.

#### CSRF 방지 방법

1. CSRF 토큰 사용

- 서버는 각 요청에 대해 고유한 CSRF 토큰을 생성하고 이를 폼에 포함시킨다. 클라이언트는 요청 시 해당 토큰을 함께 전송하고, 서버는 이를 검증하여 요청의 유효성을 확인한다.

2. SameSite 속성 설정

- SameSite 쿠키 속성을 사용하여 쿠키가 동일 사이트 요청에서만 전송되도록 설정한다.

3. Double Submit Cookies

- CSRF 토큰을 쿠키와 요청 본문에 동시에 전송하여 비교한다. 이는 서버가 상태를 유지할 필요 없이 CSRF 방지를 가능하게 한다.

### XSS 공격 방지

- XSS는 사용자가 입력한 데이터가 검증 없이 웹 페이지에 포함될 때 발생하며, 공격자는 이를 통해 악성 스크립트를 삽입하고 실행할 수 있다.

1. 입력 값 검증 및 인코딩

- 입력 값 검증

  - 사용자가 입력한 모든 데이터를 철저히 검증하고, 가능한 경우 허용된 값만을 허용한다. 예를 들어, 이메일 주소, 전화번호 등 특정 형식을 가진 입력만을 허용한다.

- 출력 값 인코딩

  - 사용자의 입력을 HTML로 출력하기 전에 반드시 인코딩합니다. 이를 통해 HTML 태그나 JavaScript 코드가 실행되지 않도록 함. 대부분의 웹 프레임워크는 이를 위한 기능을 제공하고 있다

2. 콘텐츠 보안 정책(CSP) 설정

- CSP는 웹 애플리케이션에서 허용된 리소스만 로드하고 실행하도록 하는 보안 정책이다. 이를 통해 외부 스크립트의 삽입을 방지할 수 있다.

3. HttpOnly 및 Secure 쿠키 설정

- HttpOnly 쿠키

  - 쿠키에 HttpOnly 속성을 설정하면 JavaScript에서 쿠키에 접근할 수 없게 되어, XSS 공격으로부터 보호할 수 있다.

- Secure 쿠키

  - Secure 속성을 설정하면 HTTPS 연결에서만 쿠키가 전송되어, 중간자 공격을 방지할 수 있다.

4. 정적 코드 분석 도구 사용

- 정적 코드 분석 도구를 사용하여 코드 내의 잠재적인 XSS 취약점을 발견하고 수정한다.

5. 프레임워크의 보안 기능 사용

- 많은 웹 프레임워크는 XSS 공격 방지 기능을 기본적으로 제공하므로 이를 적극 활용한다. 예를 들어, Django와 같은 프레임워크는 자동으로 출력 인코딩을 수행한다.

6. HTML 템플릿 엔진 사용

- HTML 템플릿 엔진을 사용하여 사용자 입력을 출력할 때 자동으로 인코딩한다. 예를 들어, Jinja2 템플릿 엔진은 기본적으로 HTML 인코딩을 수행한다.

7. 자바스크립트의 사용 제한

- 가능한 경우, 사용자로부터 입력받은 데이터를 직접 자바스크립트 코드 내에서 사용하는 것을 피하고, HTML 인코딩을 통해 출력하도록 한다.

8. 사용자 입력을 직접 DOM에 삽입하지 않기

- 사용자 입력을 DOM에 직접 삽입하는 것을 피하고, 대신 안전한 방법으로 데이터를 삽입한다.
